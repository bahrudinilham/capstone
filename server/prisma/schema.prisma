generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Course {
  course_id        Int               @id @default(autoincrement())
  learning_path_id Int
  course_name      String            @unique
  course_level_str Int
  hours_to_study   Int
  CourseLevel      CourseLevel       @relation(fields: [course_level_str], references: [id])
  LearningPath     LearningPath      @relation(fields: [learning_path_id], references: [learning_path_id], onDelete: Cascade)
  StudentProgress  StudentProgress[]
  Tutorial         Tutorial[]

  @@index([course_level_str], map: "Course_course_level_str_fkey")
  @@index([learning_path_id], map: "Course_learning_path_id_fkey")
}

model CourseLevel {
  id           Int      @id @default(autoincrement())
  course_level String
  Course       Course[]
}

model LearningPath {
  learning_path_id   Int               @id @default(autoincrement())
  learning_path_name String
  Course             Course[]
  StudentProgress    StudentProgress[]
}

model Student {
  student_id      Int               @id @default(autoincrement())
  name            String
  email           String            @unique
  StudentProgress StudentProgress[]
}

model StudentProgress {
  progress_id                   Int          @id @default(autoincrement())
  student_id                    Int
  course_name                   String
  learning_path_id              Int
  active_tutorials              Int          @default(0)
  completed_tutorials           Int          @default(0)
  is_graduated                  Boolean      @default(false)
  already_generated_certificate Boolean      @default(false)
  final_submission_id           Int?
  submission_rating             Int?
  final_exam_id                 Int?
  exam_score                    Int?
  started_learning_at           DateTime
  Course                        Course       @relation(fields: [course_name], references: [course_name], onDelete: Cascade)
  LearningPath                  LearningPath @relation(fields: [learning_path_id], references: [learning_path_id], onDelete: Cascade)
  Student                       Student      @relation(fields: [student_id], references: [student_id], onDelete: Cascade)

  @@index([course_name], map: "StudentProgress_course_name_fkey")
  @@index([learning_path_id], map: "StudentProgress_learning_path_id_fkey")
  @@index([student_id], map: "StudentProgress_student_id_fkey")
}

model Tutorial {
  tutorial_id    Int    @id @default(autoincrement())
  course_id      Int
  tutorial_title String
  Course         Course @relation(fields: [course_id], references: [course_id], onDelete: Cascade)

  @@index([course_id], map: "Tutorial_course_id_fkey")
}
